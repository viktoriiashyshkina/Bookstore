<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <title>Book Filter Results</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
    }
    .category-dropdown {
      margin-bottom: 20px;
    }
    .book-container {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 20px;
    }
    .book-card {
      border: 1px solid #ddd;
      border-radius: 5px;
      padding: 15px;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    }
    .book-card img {
      max-width: 100%;
      height: auto;
      margin-bottom: 10px;
    }
    .pagination {
      margin-top: 20px;
      display: flex;
      justify-content: center;
      gap: 10px;
    }
    .pagination a {
      padding: 8px 12px;
      text-decoration: none;
      background-color: #f1f1f1;
      border: 1px solid #ddd;
      color: #333;
    }
    .pagination a.active {
      background-color: #333;
      color: #fff;
      border-color: #333;
    }
  </style>
</head>
<body>

<h1>Book Filter Results</h1>

<!-- Category Dropdown -->
<div class="category-dropdown">
  <label for="category-select">Filter by Category:</label>
  <select id="category-select" onchange="window.location.href='?category=' + this.value;">
    <option value="">Select Category</option>
    <option value="fiction" th:selected="${category == 'Fiction'}">Fiction</option>
    <option value="non-fiction" th:selected="${category == 'non-fiction'}">Non-fiction</option>
    <option value="mystery" th:selected="${category == 'mystery'}">Mystery</option>
    <option value="fantasy" th:selected="${category == 'fantasy'}">Fantasy</option>
  </select>
</div>

!-- Book List -->
<div class="book-container">
  <div th:each="book : ${books}" class="book-card">
    <img th:src="${book.imageDataBase64}" alt="Book Image" th:if="${book.imageDataBase64}" />
    <h3 th:text="${book.title}">Book Title</h3>
    <p><strong>Authors:</strong> <span th:text="${#strings.arrayJoin(book.author.toArray(), ', ')}">Author Names</span></p>
    <p><strong>Price:</strong> <span th:text="${book.price}">$0.00</span></p>
    <p><strong>Category:</strong> <span th:text="${book.category}">Category</span></p>
    <p><strong>Description:</strong> <span th:text="${book.description}">Description goes here.</span></p>
  </div>
</div>

<!-- No Results Message -->
<div th:if="${books == null or books.isEmpty()}">
  <p>No books found for the selected category.</p>
</div>

<!-- Pagination -->
<div class="pagination">
  <a th:href="@{/filterByCategory(category=${category}, page=0)}" th:classappend="${currentPage == 0} ? 'active' : ''">First</a>
  <a th:href="@{/filterByCategory(category=${category}, page=${currentPage - 1})}" th:if="${currentPage > 0}">Previous</a>
  <span th:each="i : ${#numbers.sequence(0, totalPages - 1)}">
        <a th:href="@{/filterByCategory(category=${category}, page=${i})}" th:text="${i + 1}"
           th:classappend="${currentPage == i} ? 'active' : ''"></a>
    </span>
  <a th:href="@{/filterByCategory(category=${category}, page=${currentPage + 1})}" th:if="${currentPage < totalPages - 1}">Next</a>
  <a th:href="@{/filterByCategory(category=${category}, page=${totalPages - 1})}"
     th:classappend="${currentPage == totalPages - 1} ? 'active' : ''">Last</a>
</div>

</body>
</html>
